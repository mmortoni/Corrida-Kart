{"version":3,"sources":["../../app-es6/controllers/CorridaController.js"],"names":["corridaCurrentInstance","corridaController","ListaCorridas","Mensagem","CorridaView","MensagemView","CorridaService","Bind","Corrida","Volta","PilotoController","ListaPilotos","VoltaHelper","CorridaController","_listaPilotos","_pilotoController","$","document","querySelector","bind","_botaoIniciarLargada","tempo","_listaCorridas","_mensagem","_service","_ordemAtual","_init","listaPilotos","coluna","inverteOrdem","ordena","p","s","hora","minuto","segundo","milissegundo","volta","horaVolta","horaCorrida","dataDiferenca","tempoVolta","vm","parentNode","style","visibility","forEach","call","querySelectorAll","el","classList","remove","horaLargada","Date","Array","join","getHours","slice","getMinutes","getSeconds","getMilliseconds","corrida","pilotos","i","geraVoltaCorrida","getTime","parseFloat","parseInt","toFixed","piloto","formataVoltaCorrida","replace","adicionaVolta","adiciona"],"mappings":"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","file":"CorridaController.js","sourcesContent":["import {ListaCorridas}    from '../models/ListaCorridas';\nimport {Mensagem}         from '../models/Mensagem';\nimport {CorridaView}      from '../views/CorridaView';\nimport {MensagemView}     from '../views/MensagemView';\nimport {CorridaService}   from '../services/CorridaService';\nimport {Bind}             from '../helpers/Bind';\nimport {Corrida}          from '../models/Corrida';\nimport {Volta}            from '../models/Volta';\nimport {PilotoController} from '../controllers/PilotoController';\nimport {ListaPilotos}     from '../models/ListaPilotos';\nimport {VoltaHelper}      from '../helpers/VoltaHelper';\n\nclass CorridaController {\n    constructor() {\n        this._listaPilotos = new ListaPilotos();\n        this._pilotoController = new PilotoController();\n        \n        let $ = document.querySelector.bind(document);\n        \n        this._botaoIniciarLargada = $('#iniciarLargada');\n\n         let tempo = new Mensagem();\n\n        this._listaCorridas = new Bind(\n            new ListaCorridas(), \n            new CorridaView($('#corridaView')), \n            'adiciona', 'esvazia' , 'ordena', 'inverteOrdem');\n       \n        this._mensagem = new Bind(\n            new Mensagem(), new MensagemView($('#mensagemView')), 'texto');    \n            \n        this._service = new CorridaService();\n\n        this._ordemAtual = '';\n\n        this._init();\n    }\n\n    _init() {\n        this._listaPilotos = this._pilotoController.listaPilotos();\n    }\n\n    ordena(coluna) {\n        if(this._ordemAtual == coluna) {\n            this._listaCorridas.inverteOrdem(); \n        } else {\n            this._listaCorridas.ordena((p, s) => p[coluna] - s[coluna]);    \n        }\n        \n        this._ordemAtual = coluna;    \n    }    \n\n    criaLargada() {\n        let hora, minuto, segundo, milissegundo, volta, horaVolta, horaCorrida, dataDiferenca, tempoVolta, tempo, vm;\n\n        this._botaoIniciarLargada.parentNode.style.visibility = 'hidden';\n\n        [].forEach.call(document.querySelectorAll('div.row.hidden'), function (el) {\n            el.classList.remove(\"hidden\");\n        });\n\n        let horaLargada = new Date();\n        hora = (Array(2).join(\"0\") + horaLargada.getHours()).slice(-2);\n        minuto = (Array(2).join(\"0\") + horaLargada.getMinutes()).slice(-2);\n        segundo = (Array(2).join(\"0\") + horaLargada.getSeconds()).slice(-2);\n        milissegundo = (Array(3).join(\"0\") + horaLargada.getMilliseconds()).slice(-3);\n\n        horaCorrida = hora + ':' + minuto + ':' + segundo + '.' + milissegundo;\n\n        let corrida = new Corrida('1', horaCorrida);\n\n        this._listaPilotos.pilotos.forEach(piloto => {\n                horaVolta = horaLargada;\n                tempo = horaVolta;\n                for (var i = 0; i < 4; i++) { \n                    horaVolta = VoltaHelper.geraVoltaCorrida(horaVolta);\n                    dataDiferenca = new Date(horaVolta.getTime() - tempo.getTime());\n\n                    minuto = (Array(2).join(\"0\") + dataDiferenca.getMinutes()).slice(-2);\n                    segundo = (Array(2).join(\"0\") + dataDiferenca.getSeconds()).slice(-2);\n                    milissegundo = (Array(3).join(\"0\") + dataDiferenca.getMilliseconds()).slice(-3);\n                    tempoVolta = minuto + ':' + segundo + '.' + milissegundo\n\n                    vm = parseFloat((1200 / parseInt(minuto + segundo + milissegundo)) * 10000).toFixed(3);\n\n                    volta = new Volta(corrida.corrida, i + 1, piloto, VoltaHelper.formataVoltaCorrida(horaVolta), tempoVolta, vm.replace('.', ','));\n                    tempo = horaVolta;\n                    corrida.adicionaVolta(volta);\n                }\n\n                horaVolta = null;\n            }\n        );\n\n        this._listaCorridas.adiciona(corrida)\n    }\n}\n\nlet corridaController = new CorridaController();\n\nexport function corridaCurrentInstance() {\n\n    return corridaController;\n\n}    \n"]}